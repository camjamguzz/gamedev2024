<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hollow Knight Style Game</title>
    <style>
        body {
            margin: 0;
            background: black;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        canvas {
            display: block;
            background: #1e1e1e;
            border: 2px solid white;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <script>
        class Game {
            constructor(canvasId) {
                this.canvas = document.getElementById(canvasId);
                this.ctx = this.canvas.getContext('2d');
                this.init();
            }

            init() {
                // Game constants
                this.GRAVITY = 0.5;
                this.JUMP_FORCE = -12;
                this.PLAYER_SPEED = 5;

                // Game objects
                this.player = this.createPlayer();
                this.platforms = this.createPlatforms();

                // Input tracking
                this.keys = new Set();

                // Event listeners
                this.setupInputHandlers();

                // Start game loop
                this.gameLoop();
            }

            createPlayer() {
                const playerImage = new Image();
                playerImage.src = 'https://piskel-imgstore-b.appspot.com/img/6a4ffc1e-adbe-11ef-9938-d9c0f7c08e34.gif';

                return {
                    x: 100,
                    y: 100,
                    width: 70,
                    height: 100,
                    dx: 0,
                    dy: 0,
                    isJumping: false,
                    isOnGround: false,
                    image: playerImage,
                };
            }

            createPlatforms() {
                return [
                    { x: 50, y: 500, width: 200, height: 20 },
                    { x: 300, y: 400, width: 150, height: 20 },
                    { x: 500, y: 300, width: 200, height: 20 },
                ];
            }

            setupInputHandlers() {
                window.addEventListener('keydown', (e) => this.keys.add(e.key));
                window.addEventListener('keyup', (e) => this.keys.delete(e.key));
            }

            handleInput() {
                const player = this.player;

                // Horizontal movement
                if (this.keys.has('ArrowLeft')) player.dx = -this.PLAYER_SPEED;
                else if (this.keys.has('ArrowRight')) player.dx = this.PLAYER_SPEED;
                else player.dx = 0;

                // Jump
                if (this.keys.has('ArrowUp') && player.isOnGround) {
                    player.dy = this.JUMP_FORCE;
                    player.isOnGround = false;
                }
            }

            applyPhysics() {
                const player = this.player;

                // Apply gravity
                player.dy += this.GRAVITY;

                // Update position
                player.x += player.dx;
                player.y += player.dy;

                // Check collisions with platforms
                this.checkPlatformCollisions();

                // Prevent falling off the bottom
                if (player.y > this.canvas.height - player.height) {
                    player.y = this.canvas.height - player.height;
                    player.dy = 0;
                    player.isOnGround = true;
                }
            }

            checkPlatformCollisions() {
                const player = this.player;
                player.isOnGround = false;

                this.platforms.forEach((platform) => {
                    if (
                        player.x < platform.x + platform.width &&
                        player.x + player.width > platform.x &&
                        player.y + player.height <= platform.y &&
                        player.y + player.height + player.dy >= platform.y
                    ) {
                        // Land on top of platform
                        player.dy = 0;
                        player.isOnGround = true;
                        player.y = platform.y - player.height;
                    }
                });
            }

            draw() {
                const ctx = this.ctx;
                const player = this.player;

                // Clear canvas
                ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

                // Draw platforms
                ctx.fillStyle = 'gray';
                this.platforms.forEach((platform) => {
                    ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
                });

                // Draw player
                if (player.image.complete) {
                    ctx.drawImage(player.image, player.x, player.y, player.width, player.height);
                } else {
                    // Fallback if image hasn't loaded
                    ctx.fillStyle = 'white';
                    ctx.fillRect(player.x, player.y, player.width, player.height);
                }
            }

            gameLoop() {
                this.handleInput();
                this.applyPhysics();
                this.draw();
                requestAnimationFrame(() => this.gameLoop());
            }
        }

        // Start the game
        new Game('gameCanvas');
    </script>
</body>
</html>
