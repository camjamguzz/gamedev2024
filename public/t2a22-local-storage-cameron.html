<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local Storage Example</title>
</head>
<body onload="loadStoredTexts()">

<h2>t2a22-local-storage-cameron.html</h2>

<!-- Input for storing and retrieving text -->
Text example: 
<input id="myText1" type="text" size="70" value="" placeholder="Write here to store"><br>

<!-- Button to store text -->
<input type="button" value="Store Text" onclick="storeText()">

<!-- Button to retrieve text -->
<input type="button" value="Retrieve Text" onclick="retrieveTexts()">

<!-- Display area for stored texts -->
<div id="storedTextsList"></div>

<script>
    // Function to load and display stored texts on page load
    function loadStoredTexts() {
        const storedTexts = JSON.parse(localStorage.getItem('myStoredTexts')) || [];
        displayTexts(storedTexts);
    }

    // Function to store text into localStorage
    function storeText() {
        const textValue = document.getElementById('myText1').value;
        if (textValue.trim() !== "") {
            const storedTexts = JSON.parse(localStorage.getItem('myStoredTexts')) || [];
            storedTexts.push(textValue); // Add the new text to the list
            localStorage.setItem('myStoredTexts', JSON.stringify(storedTexts));
            document.getElementById('myText1').value = ''; // Clear the input field
            displayTexts(storedTexts); // Update the displayed list
        }
    }

    // Function to retrieve and display all stored texts
    function retrieveTexts() {
        const storedTexts = JSON.parse(localStorage.getItem('myStoredTexts')) || [];
        displayTexts(storedTexts);
    }

    // Function to display texts in a list format and make them clickable
    function displayTexts(texts) {
        const listContainer = document.getElementById('storedTextsList');
        listContainer.innerHTML = ''; // Clear the current list
        if (texts.length > 0) {
            const ul = document.createElement('ul'); // Create a list container
            texts.forEach(text => {
                const li = document.createElement('li'); // Create a list item
                li.textContent = text; // Set the text content
                li.style.cursor = 'pointer'; // Make it look clickable
                li.onclick = () => populateTextField(text); // Add click event to populate the input field
                ul.appendChild(li); // Add to the list
            });
            listContainer.appendChild(ul); // Display the list
        } else {
            listContainer.textContent = 'No stored texts found.';
        }
    }

    // Function to populate the input field with the clicked text
    function populateTextField(text) {
        document.getElementById('myText1').value = text;
    }

    // Automatically save text when the user leaves the page
    window.onunload = function () {
        const textValue = document.getElementById('myText1').value;
        if (textValue.trim() !== "") {
            const storedTexts = JSON.parse(localStorage.getItem('myStoredTexts')) || [];
            storedTexts.push(textValue); // Add unsaved text to the list
            localStorage.setItem('myStoredTexts', JSON.stringify(storedTexts));
        }
    };
</script>

</body>
</html>
