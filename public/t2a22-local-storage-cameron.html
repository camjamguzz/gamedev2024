<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cooler Local Storage Example</title>
    <style>
        /* ... (existing styles) ... */
    </style>
</head>
<body onload="loadStoredTexts()">

<h2>Cooler Local Storage Example</h2>

<!-- Input for storing and retrieving text -->
Text example: 
<input id="myText1" type="text" placeholder="Write here to store..."><br>

<!-- Buttons for actions -->
<input type="button" value="Store Text" onclick="storeText()">
<input type="button" value="Retrieve Text" onclick="retrieveTexts()">
<input type="button" value="Delete Text" onclick="startDeleteMode()">
<input type="button" value="Edit Text" onclick="startEditMode()">

<!-- Display area for stored texts (initially hidden) -->
<div id="storedTextsList" style="display: none;"></div>

<script>
    let deleteMode = false;
    let editMode = false;
    let editIndex = null; // To keep track of the index being edited

    // Load stored texts silently on page load
    function loadStoredTexts() {
        JSON.parse(localStorage.getItem('myStoredTexts')) || [];
    }

    // Store text into localStorage
    function storeText() {
        const textValue = document.getElementById('myText1').value;
        if (textValue.trim() !== "") {
            const storedTexts = JSON.parse(localStorage.getItem('myStoredTexts')) || [];
            if (editMode && editIndex !== null) {
                // Update the text at the selected index
                storedTexts[editIndex] = textValue;
                editMode = false; // Exit edit mode
                editIndex = null; // Clear the index
            } else {
                storedTexts.push(textValue); // Add the new text to the list
            }
            localStorage.setItem('myStoredTexts', JSON.stringify(storedTexts));
            document.getElementById('myText1').value = ''; // Clear the input field
        }
    }

    // Retrieve and display all stored texts
    function retrieveTexts() {
        const storedTexts = JSON.parse(localStorage.getItem('myStoredTexts')) || [];
        displayTexts(storedTexts);
        document.getElementById('storedTextsList').style.display = 'block';
        deleteMode = false;
        editMode = false;
    }

    // Enable delete mode
    function startDeleteMode() {
        const storedTexts = JSON.parse(localStorage.getItem('myStoredTexts')) || [];
        if (storedTexts.length === 0) {
            alert('No stored texts to delete.');
            return;
        }
        displayTexts(storedTexts);
        document.getElementById('storedTextsList').style.display = 'block';
        deleteMode = true;
        editMode = false;
    }

    // Enable edit mode
    function startEditMode() {
        const storedTexts = JSON.parse(localStorage.getItem('myStoredTexts')) || [];
        if (storedTexts.length === 0) {
            alert('No stored texts to edit.');
            return;
        }
        displayTexts(storedTexts);
        document.getElementById('storedTextsList').style.display = 'block';
        deleteMode = false;
        editMode = true;
    }

    // Display texts in a list format and make them clickable
    function displayTexts(texts) {
        const listContainer = document.getElementById('storedTextsList');
        listContainer.innerHTML = '';
        if (texts.length > 0) {
            const ul = document.createElement('ul');
            texts.forEach((text, index) => {
                const li = document.createElement('li');
                li.textContent = text;
                li.style.cursor = 'pointer';
                li.onclick = () => {
                    if (deleteMode) {
                        deleteText(index);
                    } else if (editMode) {
                        populateTextFieldForEdit(index, text);
                    } else {
                        populateTextField(text);
                    }
                };
                ul.appendChild(li);
            });
            listContainer.appendChild(ul);
        } else {
            listContainer.textContent = 'No stored texts found.';
        }
    }

    // Populate the input field with the clicked text for editing
    function populateTextFieldForEdit(index, text) {
        document.getElementById('myText1').value = text;
        editIndex = index; // Save the index for updating
    }

    // Populate the input field with the clicked text for viewing
    function populateTextField(text) {
        document.getElementById('myText1').value = text;
    }

    // Delete a text by its index
    function deleteText(index) {
        const storedTexts = JSON.parse(localStorage.getItem('myStoredTexts')) || [];
        if (index >= 0 && index < storedTexts.length) {
            storedTexts.splice(index, 1);
            localStorage.setItem('myStoredTexts', JSON.stringify(storedTexts));
            displayTexts(storedTexts);
        }
        deleteMode = false;
    }

    // Automatically save text when the user leaves the page
    window.onunload = function () {
        const textValue = document.getElementById('myText1').value;
        if (textValue.trim() !== "") {
            const storedTexts = JSON.parse(localStorage.getItem('myStoredTexts')) || [];
            storedTexts.push(textValue);
            localStorage.setItem('myStoredTexts', JSON.stringify(storedTexts));
        }
    };
</script>

</body>
</html>
